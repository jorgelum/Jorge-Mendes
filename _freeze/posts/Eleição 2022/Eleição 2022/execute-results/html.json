{
  "hash": "259f78886823e3f56977bc42e0961d1e",
  "result": {
    "markdown": "---\ntitle: \"Eleição 2022\"\nauthor: \"Jorge Luiz Mendes\"\ndate: \"2023/12/29\"\nimage: \"image0.png\"\ndescription: \"As eleições de 2022 foram extremamente concorridas, sendo bem disputadas no primeiro e no segundo turno.\"\ncategories: [governo,Dados,geobr,analytics,ggplot]\n---\n\n\n## Introdução\n\nAs eleições de 2022 foram extremamente concorridas, sendo bem disputadas no primeiro e no segundo turno. Eu quero analisar a quantidade de votos em cada partido, em cada turno e obter outras informações relevantes.\n\n![Fonte: https://agenciabrasil.ebc.com.br/](image0.png){fig-align=\"center\" width=\"579\"}\n\n## Bibliotecas\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr) #tratamento de dados\nlibrary(tidyr) #tratamento de dados\nlibrary(ggplot2) #gráficos\nlibrary(readr) #leitura de dados\nlibrary(sf) #mapas\nlibrary(geobr) #mapas\nlibrary(knitr) #tabelas \nlibrary(kableExtra) #tabelas \nlibrary(glue) \n```\n:::\n\n\n## Dados\n\nO estudo desse post diz respeito das eleições de 2022 com foco no estado de São Paulo. Os dados se tratam de votos válidos, não nulos e não brancos, ou seja, somente o resultado dos partidos. Eles foram obtidos do projeto Base dos Dados, deixo [aqui](https://jormendes.netlify.app/posts/base%20dos%20dados/base%20dos%20dados) um pequeno tutorial de como utiliza-lo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndados <- readr::read_csv(\"dados.csv\") \ndados |> head() |> knitr::kable()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> ano </th>\n   <th style=\"text-align:right;\"> turno </th>\n   <th style=\"text-align:left;\"> tipo_eleicao </th>\n   <th style=\"text-align:left;\"> sigla_uf </th>\n   <th style=\"text-align:right;\"> id_municipio </th>\n   <th style=\"text-align:right;\"> id_municipio_tse </th>\n   <th style=\"text-align:left;\"> cargo </th>\n   <th style=\"text-align:right;\"> numero_partido </th>\n   <th style=\"text-align:left;\"> sigla_partido </th>\n   <th style=\"text-align:right;\"> numero_candidato </th>\n   <th style=\"text-align:right;\"> sequencial_candidato </th>\n   <th style=\"text-align:right;\"> id_candidato_bd </th>\n   <th style=\"text-align:left;\"> resultado </th>\n   <th style=\"text-align:right;\"> votos </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 2022 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> eleicao ordinaria </td>\n   <td style=\"text-align:left;\"> SP </td>\n   <td style=\"text-align:right;\"> 3500105 </td>\n   <td style=\"text-align:right;\"> 61018 </td>\n   <td style=\"text-align:left;\"> presidente </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> PSTU </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 280001607831 </td>\n   <td style=\"text-align:right;\"> 27173 </td>\n   <td style=\"text-align:left;\"> nao eleito </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2022 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> eleicao ordinaria </td>\n   <td style=\"text-align:left;\"> SP </td>\n   <td style=\"text-align:right;\"> 3500204 </td>\n   <td style=\"text-align:right;\"> 61034 </td>\n   <td style=\"text-align:left;\"> presidente </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> PSTU </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 280001607831 </td>\n   <td style=\"text-align:right;\"> 27173 </td>\n   <td style=\"text-align:left;\"> nao eleito </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2022 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> eleicao ordinaria </td>\n   <td style=\"text-align:left;\"> SP </td>\n   <td style=\"text-align:right;\"> 3500303 </td>\n   <td style=\"text-align:right;\"> 61050 </td>\n   <td style=\"text-align:left;\"> presidente </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> PSTU </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 280001607831 </td>\n   <td style=\"text-align:right;\"> 27173 </td>\n   <td style=\"text-align:left;\"> nao eleito </td>\n   <td style=\"text-align:right;\"> 4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2022 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> eleicao ordinaria </td>\n   <td style=\"text-align:left;\"> SP </td>\n   <td style=\"text-align:right;\"> 3500402 </td>\n   <td style=\"text-align:right;\"> 61077 </td>\n   <td style=\"text-align:left;\"> presidente </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> PSTU </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 280001607831 </td>\n   <td style=\"text-align:right;\"> 27173 </td>\n   <td style=\"text-align:left;\"> nao eleito </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2022 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> eleicao ordinaria </td>\n   <td style=\"text-align:left;\"> SP </td>\n   <td style=\"text-align:right;\"> 3500501 </td>\n   <td style=\"text-align:right;\"> 61093 </td>\n   <td style=\"text-align:left;\"> presidente </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> PSTU </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 280001607831 </td>\n   <td style=\"text-align:right;\"> 27173 </td>\n   <td style=\"text-align:left;\"> nao eleito </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2022 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> eleicao ordinaria </td>\n   <td style=\"text-align:left;\"> SP </td>\n   <td style=\"text-align:right;\"> 3500550 </td>\n   <td style=\"text-align:right;\"> 70190 </td>\n   <td style=\"text-align:left;\"> presidente </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:left;\"> PSTU </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 280001607831 </td>\n   <td style=\"text-align:right;\"> 27173 </td>\n   <td style=\"text-align:left;\"> nao eleito </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Visão Geral\n\n**Qual o número total de votos que os partidos receberam do estado de São Paulo?**\n\nPrimeiro vou agrupar a soma total dos votos por turnos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- dados |> \n  dplyr::group_by(turno) |> \n  dplyr::summarise(N_votos = sum(votos)) |> \n  dplyr::mutate(turno =case_when(\n     turno == 1 ~\"1°\",\n     turno == 2 ~\"2°\"\n   ))\ndif_perc <-round(((df$N_votos[2] - df$N_votos[1])/df$N_votos[1])*100,2)\n```\n:::\n\n\nAgora posso plotar os dados com ggplot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf |> \n  dplyr::mutate(N_votos = N_votos/1000000) |> \n  ggplot2::ggplot(aes(x =turno,y =N_votos,fill =turno,label = round(N_votos,2))) +\n  geom_col(width = 0.5) + \n  scale_fill_manual(values = c(\"#6cb898\",\"#6c9cb8\"),name = \"Turno\") + \n  labs(title = \"Número de votantes por turno no estado de SP\",\n       subtitle = \"eleições de 2022\",\n       x= 'Turno', y= 'Número de votos(em milhões)',\n       legend = \"Turno\"\n       ) +\n  annotate(\"text\",x=1.5,y =18, label = glue::glue('Aumento de\\n{dif_perc}%')) +\n  geom_label(size = 4) +\n\n  theme(plot.title = element_text(face = \"bold\"))\n```\n\n::: {.cell-output-display}\n![](Eleição-2022_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Nota\n\nHouve um aumento de 80 mil votos em relação ao primeiro turno mostrando que ocorreu uma migração possívelmente dos votos nulos e brancos, ou aqueles que não participaram da votação do primeiro dia. Claro nem todos que votaram no votaram no segundo e vice versa.\n:::\n\n**Como foi o resultado do primeiro turno?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndados |> \n  dplyr::filter(turno==1) |> \n  dplyr::group_by(sigla_partido) |>\n  dplyr::summarise(votos = sum(votos)) |>\n  dplyr::arrange(desc(votos)) |> \n  knitr::kable(col.names = c(\"Partido\", \"Votos\"),\n               caption = \"Resultado dos Partidos no Primeiro 1°\",\n               align = 'cc')\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Resultado dos Partidos no Primeiro 1°</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> Partido </th>\n   <th style=\"text-align:center;\"> Votos </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> PL </td>\n   <td style=\"text-align:center;\"> 12239989 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> PT </td>\n   <td style=\"text-align:center;\"> 10490032 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> MDB </td>\n   <td style=\"text-align:center;\"> 1625596 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> PDT </td>\n   <td style=\"text-align:center;\"> 898540 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> NOVO </td>\n   <td style=\"text-align:center;\"> 183719 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> UNIÃO </td>\n   <td style=\"text-align:center;\"> 153601 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> UP </td>\n   <td style=\"text-align:center;\"> 21665 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> PTB </td>\n   <td style=\"text-align:center;\"> 15784 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> PCB </td>\n   <td style=\"text-align:center;\"> 14943 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> PSTU </td>\n   <td style=\"text-align:center;\"> 7450 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> DC </td>\n   <td style=\"text-align:center;\"> 5015 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n**Quem venceu em cada município no primeiro turno?**\n\nPosso plotar um mapa utilizando o pacote **geobr**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsp_mapa <- geobr::read_municipality(code_muni = 35, year=2018) |> \n  dplyr::rename( id_municipio = code_muni )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing year 2018\n```\n:::\n:::\n\n\nDeterminar os vencedores.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsp_dados_1 <- dados |> \n  dplyr::filter(turno==1) |> \n  dplyr::group_by(id_municipio) |> \n  dplyr::filter(votos == max(votos)) |> \n  dplyr::left_join(sp_mapa,by ='id_municipio')\n```\n:::\n\n\nPlotando os dados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsp_dados_1 |> \n  ggplot2::ggplot(ggplot2::aes(geometry = geom,fill = sigla_partido),\n                     color= \"black\") +\n  ggplot2::geom_sf() +\n  ggplot2::scale_fill_brewer(palette = \"Set1\",direction = -1,name = \"Partido\") +\n  labs(title = \"Estado de São Paulo\", subtitle = \"Resultado do 1° turno (2022)\") +\n  ggplot2::theme_void()\n```\n\n::: {.cell-output-display}\n![](Eleição-2022_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-tip collapse=\"true\"}\n## Curiosidade\n\nOcorreu um empate no município de Ribeirão do Sul com PT e PL ficaram cada um com 1452 votos.\n:::\n\n**Qual partido levou mais municípios no primeiro turno?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsp_dados_1 |>\n  dplyr::group_by(sigla_partido) |> \n  dplyr::summarise(Contagem = n()) |> \n  ggplot2::ggplot(aes(x = sigla_partido,y = Contagem)) +\n  ggplot2::geom_col(width = 0.5, fill = c('#295191','#c70c18')) +\n  labs(title = \"Número de Vitórias por Município\", subtitle =  \"eleições de 2022(1°turno)\",\n       y =\"\", x = \"Partidos\") +\n  theme(plot.title = element_text(face = \"bold\"))\n```\n\n::: {.cell-output-display}\n![](Eleição-2022_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n**Como ficou a região do ABC?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlistaABC = list(3548708, 3547809, 3529401, 3513801, 3548807, 3543303, 3544103)\nsp_dados_1 |> dplyr::filter(id_municipio %in% listaABC) |>  \n  ggplot2::ggplot(ggplot2::aes(geometry = geom,fill = sigla_partido),\n                     color= \"black\") +\n  ggplot2::geom_sf() +\n  ggplot2::scale_fill_brewer(palette = \"Set1\",direction = -1,name =\"Partido\") +\n  labs(title = \"Região do Grande ABC\",\n       subtitle = \"Vencedores do primeiro 1°(2022)\") +\n  geom_sf_label(aes(label = name_muni, colors='white')) +\n  ggplot2::theme_void()\n```\n\n::: {.cell-output-display}\n![](Eleição-2022_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n## Segundo Turno\n\nAgora com 2 partidos fica mais fácil comparar resultados. Podemos comparar a diferença de votos entre os partidos em cada turno.\n\n**Qual a porcentagem de votos que eles ganharam no segundo turno?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndados |> dplyr::filter(sigla_partido %in% c(\"PL\",\"PT\")) |> \n  dplyr::group_by(turno,sigla_partido) |> \n  dplyr::summarise(soma = sum(votos)) |> \n  tidyr::spread(key = turno,value = soma) |> \n  dplyr::rename(primeiro ='1',segundo = '2') |> \n  dplyr::mutate(dif = round(100*(segundo - primeiro)/primeiro,2)) |> \n  knitr::kable(col.names = c(\"Partido\", \"Primeiro\",\"Segundo\",\"Diferença de Votos (%)\"),\n               caption = \"Resultado dos Partidos nas Eleições de 2022\",\n               align = 'cccc') |> \n  kableExtra::add_header_above(c(\" \" = 1,\"Turno\" = 2, \" \" = 1))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n<caption>Resultado dos Partidos nas Eleições de 2022</caption>\n <thead>\n<tr>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"2\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Turno</div></th>\n<th style=\"empty-cells: hide;border-bottom:hidden;\" colspan=\"1\"></th>\n</tr>\n  <tr>\n   <th style=\"text-align:center;\"> Partido </th>\n   <th style=\"text-align:center;\"> Primeiro </th>\n   <th style=\"text-align:center;\"> Segundo </th>\n   <th style=\"text-align:center;\"> Diferença de Votos (%) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> PL </td>\n   <td style=\"text-align:center;\"> 12239989 </td>\n   <td style=\"text-align:center;\"> 14216587 </td>\n   <td style=\"text-align:center;\"> 16.15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> PT </td>\n   <td style=\"text-align:center;\"> 10490032 </td>\n   <td style=\"text-align:center;\"> 11519882 </td>\n   <td style=\"text-align:center;\"> 9.82 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n**Quem venceu em cada município no segundo turno?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsp_dados_2 <- dados |> \n  dplyr::filter(turno==2) |> \n  dplyr::group_by(id_municipio) |> \n  dplyr::filter(votos == max(votos)) |> \n  dplyr::left_join(sp_mapa,by ='id_municipio')\n\nsp_dados_2 |> \n  ggplot2::ggplot(ggplot2::aes(geometry = geom,fill = sigla_partido),\n                     color= \"black\") +\n  ggplot2::geom_sf() +\n  ggplot2::scale_fill_brewer(palette = \"Set1\",direction = -1,name =\"Partido\") +\n  labs(title = \"Estado de São Paulo\", subtitle = \"Resultado do 2° turno (2022)\") +\n  ggplot2::theme_void()\n```\n\n::: {.cell-output-display}\n![](Eleição-2022_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## Curiosidade\n\nOcorreu um empate no município de Guará com PT e PL ficaram cada um com 5529 votos.\n:::\n\n**Qual partido levou mais municípios no segundo turno?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsp_dados_2 |>\n  dplyr::group_by(sigla_partido) |> \n  dplyr::summarise(Contagem = n()) |> \n  ggplot2::ggplot(aes(x = sigla_partido,y = Contagem)) +\n  ggplot2::geom_col(width = 0.5, fill = c('#295191','#c70c18')) +\n  labs(title = \"Número de Vitórias por Município\", subtitle =  \"eleições de 2022 (2°turno)\",\n       y =\"\", x = \"Partidos\") +\n  theme(plot.title = element_text(face = \"bold\"))\n```\n\n::: {.cell-output-display}\n![](Eleição-2022_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n**Como ficou a região do ABC no segundo turno?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsp_dados_2 |> dplyr::filter(id_municipio %in% listaABC) |>  \n  ggplot2::ggplot(ggplot2::aes(geometry = geom,fill = sigla_partido),\n                     color= \"black\") +\n  ggplot2::geom_sf() +\n  ggplot2::scale_fill_brewer(palette = \"Set1\",direction = -1,name =\"Partido\") +\n  labs(title = \"Região do Grande ABC\",\n       subtitle = \"Vencedores do primeiro 2°(2022)\") +\n  geom_sf_label(aes(label = name_muni, colors='white')) +\n  ggplot2::theme_void()\n```\n\n::: {.cell-output-display}\n![](Eleição-2022_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n## Conclusão\n\nFoi possível tirar muitas informações de um pequeno dataset. O projeto **Base dos Dados** possui mais tabelas com dados de perfil eleitoral, gastos, votos nulos e brancos., sendo possível realizar análises mais completas.\n",
    "supporting": [
      "Eleição-2022_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}